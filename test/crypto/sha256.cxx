// SPDX-License-Identifier: BSD-3-Clause
#include <cstdint>
#include <substrate/crypto/sha256>
#include <catch2/catch.hpp>

using namespace substrate;

TEST_CASE("sha256: empty hash", "[crypto/sha256]")
{
	crypto::sha256_t hasher{};

	std::array<int8_t, 0> empty_input{{}};
	std::array<uint8_t, 32> empty_hash{{
		0xe3U, 0xb0U, 0xc4U, 0x42U,
		0x98U, 0xfcU, 0x1cU, 0x14U,
		0x9aU, 0xfbU, 0xf4U, 0xc8U,
		0x99U, 0x6fU, 0xb9U, 0x24U,
		0x27U, 0xaeU, 0x41U, 0xe4U,
		0x64U, 0x9bU, 0x93U, 0x4cU,
		0xa4U, 0x95U, 0x99U, 0x1bU,
		0x78U, 0x52U, 0xb8U, 0x55U
	}};

	REQUIRE(hasher(empty_input) == empty_hash);
}

TEST_CASE("sha256: std::array<>", "[crypto/sha256]")
{
	crypto::sha256_t hasher{};

	std::array<int8_t, 3> small_input{{ 'n', 'y', 'a' }};
	std::array<uint8_t, 32> small_hash{{
		0xe7U, 0xa0U, 0x0eU, 0x53U,
		0xbdU, 0x04U, 0xbfU, 0x48U,
		0xc4U, 0xcdU, 0xe3U, 0x00U,
		0xb1U, 0x1fU, 0x10U, 0xdeU,
		0xceU, 0xe1U, 0x8dU, 0x7aU,
		0x82U, 0x55U, 0x02U, 0xc4U,
		0xedU, 0xcbU, 0xc2U, 0xfaU,
		0x38U, 0xf7U, 0xfaU, 0x1f
	}};

	REQUIRE(hasher(small_input) == small_hash);

}
